(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{333:function(s,t,a){"use strict";a.r(t);var n=a(33),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[s._v("#")]),s._v(" 插件")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("为什么要使用插件？？")]),s._v(" "),a("ul",[a("li",[s._v("中间件加载其实是有先后顺序的，但是中间件自身缺无法管理这种顺序，只能交给使用者，这样其实不友好，一旦顺序不对，结果可能有天壤之别")]),s._v(" "),a("li",[s._v("中间件的定位是拦截用户请求，并在它前后做一些事情，例如：鉴权，安全检查，访问日志等等，但实际情况是，有些功能是和请求无关的，例如：定时任务，消息订阅，后台逻辑等等。")]),s._v(" "),a("li",[s._v("有些功能包含非常复杂的初始化逻辑，需要在应用启动的时候完成，这显然也不适合放到中间件去实现。")])])]),s._v(" "),a("li",[a("p",[s._v("插件")]),s._v(" "),a("ul",[a("li",[s._v("包含了service, 中间件，配置，框架扩展等等。")]),s._v(" "),a("li",[s._v("没有独立的Router和Controller")]),s._v(" "),a("li",[s._v("没有"),a("code",[s._v("plugin.js")]),s._v(" 只能声明跟其他插件的依赖，而不能决定其他插件的开启与否。")])])]),s._v(" "),a("li",[a("p",[s._v("使用(外置插件)")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" 需要去安装对应的插件  例如 egg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("view"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ejs\n   npm install egg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("view"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ejs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save\n   \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" 需要将插件引入到plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js 中\n  \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//plugin.js")]),s._v("\nejs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    enable"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否开启插件，默认是开启的")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'egg-view-ejs'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 插件的名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" 如果插件需要进行全局的配置，那么，就需要去config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js中进行配置\n   插件本身都有自己的配置，这里可以用于覆盖插件自身的配置\n\n  config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("view "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      mapping"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.html'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ejs'")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里就是ejs模板 配置是以html结尾的文件")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("配置插件的参数介绍")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//plugin.js")]),s._v("\nejs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    enable"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否开启插件，默认是开启的  false 是不开启")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'egg-view-ejs'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// npm 模块名称    通过npm 模块的形式引入插件 这个插件一般属于成熟的插件，发布的")]),s._v("\n    path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 插件的绝对路径，与package是互斥的，有你没我  这里主要用于本项目内没有完成，或者没有发布的一些插件，所以这里用路径获取")]),s._v("\n    env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 启动这个插件的环境，会覆盖插件自身的package.json中的配置  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("内置插件列表")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("onerror       统一异常处理\nSession       Session 实现\ni18n          多语言\nwatcher       文件和文件夹监控\nmultipart     文件流式上传\nsecurity      安全\ndevelopment   开发环境配置\nlogrotator    日志切分\nschedule      定时任务\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v("        静态服务器\njsonp         jsonp 支持\nview          模板引擎\n")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);