# 浅谈 I/O

#### 什么是I/O

- 简单就是input/output, 输入和输出
- 主要来自于网络请求和文件的写入读取
- 一次I/O 分为两个阶段 **等待资源阶段**  和 **使用资源阶段**

#### 阻塞I/O 和  非阻塞I/O

- 首先，这两个`I/O`， 是对于操作系统的内核而言的，根据发起的`I/O` 是不是阻塞了，来判断和区分的。
- **阻塞I/O 和  非阻塞I/O**， 其实就是发生在**等待资源阶段**。
- **阻塞I/O**： 其实就是用户发起了一个`I/O`请求之后，只有当响应 有返回或者超时的时候，用户才能处理其他的事情，如果一直没有返回和超时，那么这个时候I/O就处于阻塞状态。
  - 举个例子： 系统内核去读取文件，然后复制文件数据，最后将数据传递回来的这个过程就是一个`I/O`的过程,   只用当内核将这个数据传回来的时候，这个`I/O`才算结束， 那么在文件读取，复制的这个过程中，其实`cpu`的资源是被浪费掉了，因为这个时候，就没法处理别的事情，只能等待。
- **非阻塞I/O**： 也是用户在发起了一个`I/O`请求之后，会立马给出响应，但是给的还不是你想要的数据，只是告诉你，内核已经知道了，正在处理你的请求，你可以先做别的事情。
  - 举个例子： 同理系统内核去读取文件，然后复制文件数据，最后将数据返回的这个过程。我们去触发读取，然后会立马给返回一个标记，内核说他知道了，正在处理，然后我们，怎么知道他处理完了？就需要用这个标记去轮询请求内核，是否完成了，最后在调用读取的数据的方式，将拿到内核处理好的数据。

#### 同步I/O 和 异步I/O

- 发生在**使用资源阶段**
- **同步I/O**： 应用发送或者接收数据之后，不返回，继续等待（此处发生阻塞），直到返回或者发生错误。
- **异步I/O**： 应用发送或者接收数据之后，立刻返回，数据写入OS缓存，由OS完成数据的发送或者接收，并返回成功或者失败的信息给应用。

